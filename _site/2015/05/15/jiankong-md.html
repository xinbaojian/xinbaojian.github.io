<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Boot 学习起步 十一、监控 - 谷梁祁承</title>
    <meta name="author"  content="辛保健">
    <meta name="description" content="Spring Boot 学习起步 十一、监控">
    <meta name="keywords"  content="技术, Java, Spring Boot">
    <!-- Open Graph -->
    <meta property="og:title" content="Spring Boot 学习起步 十一、监控 - 谷梁祁承">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://localhost:4000/2015/05/15/jiankong-md.html">
    <meta property="og:description" content="眼中总有光芒，活成想要的模样。">
    <meta property="og:site_name" content="谷梁祁承">
    <link rel="stylesheet" href="//cdn.staticfile.org/normalize/6.0.0/normalize.min.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_roc50gemkxpw4s4i.css">
    <link rel="stylesheet" href="/assets/css/github-markdown.css">
    <link rel="stylesheet" href="/assets/css/prism.css">
    <link rel="stylesheet" href="/assets/css/share.min.css">
    <link rel="stylesheet" href="/assets/css/app.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
	
	<!--
Author: Ray-Eldath
refer to:
 - http://docs.mathjax.org/en/latest/options/index.html
-->

	<script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["$", "$"] ],
			displayMath: [ ["$$", "$$"] ],
			skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
		},
		"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
      });
    </script>

	
    <!--
Author: Ray-Eldath
-->
<style>
    .markdown-body .anchor{
        float: left;
        margin-top: -8px;
        margin-left: -20px;
        padding-right: 4px;
        line-height: 1;
        opacity: 0;
    }
    
    .markdown-body .anchor .anchor-icon{
        font-size: 15px
    }
</style>
<script>
    $(document).ready(function() {
        let nodes = document.querySelector(".markdown-body").querySelectorAll("h1,h2,h3")
        for(let node of nodes) {
            var anchor = document.createElement("a")
            var anchorIcon = document.createElement("i")
            anchorIcon.setAttribute("class", "fa fa-anchor fa-lg anchor-icon")
            anchorIcon.setAttribute("aria-hidden", true)
            anchor.setAttribute("class", "anchor")
            anchor.setAttribute("href", "#" + node.getAttribute("id"))
            
            anchor.onmouseover = function() {
                this.style.opacity = "0.4"
            }
            
            anchor.onmouseout = function() {
                this.style.opacity = "0"
            }
            
            anchor.appendChild(anchorIcon)
            node.appendChild(anchor)
        }
    })
</script>
</head>


<body>
  <!--[if lt IE 10]>
<div class="alert-danger" role="alert">你的浏览器实在太太太旧了，放学别走，升级完浏览器再说！<a target="_blank" class="alert-link" href="http://browsehappy.com">立即升级</a></div>
<![endif]-->
  <input id="nm-switch" type="hidden" value="true"> <header class="g-header">
    <div class="g-logo">
      <a href="/"></a>
    </div>
    <i id="menu-toggle" class="iconfont icon-menu"></i>
    <nav class="g-nav">
        <ul>
            
            <li><a href="/">home</a></li>
            
            <li><a href="/tags.html">tags</a></li>
            
        </ul>
    </nav>
</header>


  <header
    class="g-banner post-header post-pattern-circuitBoard bgcolor-default post-no-cover"
    data-theme="default"
  >
    <div class="post-wrapper">
      <div class="post-tags">
        
          
            <a href="http://localhost:4000/tags#%E6%8A%80%E6%9C%AF" class="post-tag">技术</a>
          
            <a href="http://localhost:4000/tags#Java" class="post-tag">Java</a>
          
            <a href="http://localhost:4000/tags#Spring%20Boot" class="post-tag">Spring Boot</a>
          
        
      </div>
      <h1>Spring Boot 学习起步 十一、监控</h1>
      <div class="post-meta">
        <span class="post-meta-item"><i class="iconfont icon-author"></i>Baojian</span>
        <time class="post-meta-item" datetime="15-05-15"><i class="iconfont icon-date"></i>15 May 2015</time>
      </div>
    </div>
    
  </header>

  <div class="post-content visible">
    
    <h2 class="post-subtitle"> "Spring Boot"</h2>
    

    <article class="markdown-body">
      <blockquote>
  <p>监控</p>
</blockquote>

<p>作为一个为微服务而生的框架，自然少不了监控，下面看看spring boot为我们提供了什么。</p>

<p>首先你需要在pom.xml中引入如下模块：</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p>启动项目，即可通过如下如下路径健康项目：</p>
<ul>
  <li>/autoconfig 显示autoconfig信息</li>
  <li>/beans 显示所有beans</li>
  <li>/configprops 显示所有配置项</li>
  <li>/dump</li>
  <li>/env 环境变量</li>
  <li>/health 健康检查</li>
  <li>/info</li>
  <li>/metrics</li>
  <li>/mappings 所有的@RequestMapping</li>
  <li>/shutdown 关闭引用，你需要配置endpoints.shutdown.enabled=true才能生效</li>
  <li>/trace 最近几次请求的信息
<!--more-->
###通过shell监控
首先添加spring-boot-starter-remote-shell依赖
    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="nt">&lt;dependency&gt;</span>
          <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-remote-shell<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;/dependency&gt;</span>
</code></pre></div>    </div>
    <p>重启应用，控制台显示访问密码：</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Using default password for shell access: 57946cf9-22a1-4415-a87e-36c38801c502
</code></pre></div>    </div>
    <p>用ssh登录：
```shell
utgard@utgard:~$ ssh -p 2000 user@localhost
Password authentication
Password:
.   <strong>__          _            __ _ _
 /\ / __<em>‘</em> __ _ <em>(</em>)_ __  __ _ \ \ \ \
( ( )_</strong> | ‘_ | ‘<em>| | ‘</em> \/ <em>` | \ \ \ \
 \/  <strong>_)| |_)| | | | | || (_| |  ) ) ) )
‘  |</strong><strong>| .</strong>|</em>| |<em>|</em>| |<em>_</em>, | / / / /
 =========|<em>|==============|</em><em>_/=/</em>/<em>/</em>/
 :: Spring Boot ::  (v1.1.8.RELEASE) on utgard</p>
    <blockquote>

    </blockquote>
  </li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```shell
&gt; help
Try one of these commands with the -h or --help switch:

NAME       DESCRIPTION
autoconfig Display auto configuration report from ApplicationContext
beans      Display beans in ApplicationContext
cron       manages the cron plugin
dashboard  a monitoring dashboard
egrep      search file(s) for lines that match a pattern
endpoint   Invoke actuator endpoints
env        display the term env
filter     a filter for a stream of map
java       various java language commands
jmx        Java Management Extensions
jul        java.util.logging commands
jvm        JVM informations
less       opposite of more
mail       interact with emails
man        format and display the on-line manual pages
metrics    Display metrics provided by Spring Boot
shell      shell related command
sleep      sleep for some time
sort       sort a map
system     vm system properties commands
thread     JVM thread commands
help       provides basic help
repl       list the repl or change the current repl

&gt; jvm
usage: jvm [-h | --help] COMMAND [ARGS]

The most commonly used jvm commands are:
   runtime          Show JVM runtime
   classloading     Show JVM classloding
   compilation      Show JVM compilation
   nonheap          Show JVM memory non heap
   pool             Show JVM memory pool
   pools            Show JVM memory pools
   top
   heap             Show JVM memory heap
   gc               Show JVM garbage collection
   system           Show JVM operating system

&gt; jvm gc

GARBAGE COLLECTION
name :PS Scavenge
name              value
------------------------------------
collection count  12
collection time   261
mpool name        PS Eden Space
mpool name        PS Survivor Space


name :PS MarkSweep
name              value
------------------------------------
collection count  3
collection time   456
mpool name        PS Eden Space
mpool name        PS Survivor Space
mpool name        PS Old Gen

</code></pre></div></div>
<p>更多内容请参考<a href="https://docs.spring.io/spring-boot/docs/1.2.0.M2/reference/htmlsingle/#production-ready">官方文档</a></p>

    </article>

    
    <div class="social-share-wrapper">
      <div class="social-share"></div>
    </div>
    
  </div>

  <section class="author-detail">
    <section class="post-footer-item author-card">
      <div class="avatar">
        <img src="http://localhost:4000/assets/img/profile.png" alt="">
      </div>
      <div class="author-name" rel="author">辛保健</div>
      <div class="bio">
        <p>后端开发者，热爱技术，简单乐观爱创造</p>
      </div>
      
      <ul class="sns-links">
        
        <li>
          <a href="//github.com/xinbaojian" target="_blank">
                    <i class="iconfont icon-github"></i>
                </a>
        </li>
        
      </ul>
      
    </section>
    <section class="post-footer-item read-next">
      
      <div class="read-next-item">
        <a href="/2015/05/16/how-to-see-the-mysql-execution-plan-md.html" class="read-next-link"></a>
        <section>
          <span>如何查看MySql的执行计划</span>
          <p>  查看执行计划</p>
        </section>
        
     </div>
      

      
      <div class="read-next-item">
        <a href="/2015/05/15/data-resouse-md.html" class="read-next-link"></a>
          <section>
            <span>Spring Boot 学习起步 十、数据访问</span>
            <p>  数据访问</p>
          </section>
          
      </div>
      
    </section>
    
  </section>

  <footer class="g-footer">
  <section>谷梁祁承 ©
  
  
    2017
    -
  
  2018
  </section>
  <section>Powered by <a href="//jekyllrb.com">Jekyll</a> | <a href="https://github.com/xinbaojian">xinbaojian</a></section>
  <section><a style="font-size:0.8rem;font-weight:100; text-decoration: none;" href="http://www.miitbeian.gov.cn" target="_blank">豫ICP备18005655号-1</a></section>
</footer>


  <script src="/assets/js/social-share.min.js"></script>
  <script>
    socialShare('.social-share', {
      sites: [
        
          'wechat'
          ,
          
        
          'weibo'
          ,
          
        
          'douban'
          ,
          
        
          'twitter'
          
        
      ],
      wechatQrcodeTitle: "分享到微信朋友圈",
      wechatQrcodeHelper: '<p>扫码后点击右上角</p><p>将本文分享至朋友圈</p>'
    });
  </script>

  

  <script src="/assets/js/prism.js"></script>
  <script src="/assets/js/index.min.js"></script>
</body>

</html>
